```yaml
models:
  - name: incremental_orders_with_customer
    description: |
      Incremental fact model optimized for recent orders that combines order-level details from the raw_orders source 
      with enriched customer information from dim_customers dimension. This model supports analytics on order performance, 
      customer segmentation, and revenue trends by materializing changes incrementally with merge strategy. 
      It captures key order information, customer demographics, and monetary metrics designed for up-to-date sales reporting.
    meta:
      owner: "analytics_engineering"
      description: "Incremental model optimized for recent orders with customer join and aggregated metrics"
      tags: ["sales", "orders"]
    columns:
      - name: order_id
        description: |
          Unique identifier for each order.
          Primary key for this model; aligns with raw_orders.order_id.
        data_type: integer
        tests:
          - unique
          - not_null

      - name: customer_id
        description: |
          Identifier linking an order to a customer.
          Foreign key referencing dim_customers.customer_id.
          May be null if customer information is missing in dim_customers.
        data_type: integer
        tests:
          - not_null
          - relationships:
              to: ref('dim_customers')
              field: customer_id

      - name: customer_name
        description: |
          Full name of the customer associated with the order.
          Sourced from dim_customers.customer_name.
          May be null if no matching customer record exists for the order.
        data_type: varchar(100)
        tests:
          - not_null: false

      - name: customer_segment
        description: |
          Customer segmentation category (e.g., Business, Consumer).
          Used in sales analysis to group customers by buying behavior.
          Examples: "Consumer", "Corporate", "Home Office".
          Sourced from dim_customers.customer_segment.
        data_type: varchar(50)
        tests:
          - accepted_values:
              values: ['Consumer', 'Corporate', 'Home Office', 'Small Business', 'Enterprise', null]
          - not_null: false

      - name: order_date
        description: |
          Date when the order was placed (date precision).
          Used to analyze trends over time and filter incremental loads.
          Sourced from raw_orders.order_date.
        data_type: date
        tests:
          - not_null
          - dbt_utils.stale:
              warn_after: {count: 24, period: hour}

      - name: order_status
        description: |
          Status of the order indicating its lifecycle stage.
          Common values include "Pending", "Shipped", "Cancelled", "Complete".
          Used to filter and segment order workflow statuses.
          Sourced from raw_orders.order_status.
        data_type: varchar(20)
        tests:
          - accepted_values:
              values: ['Pending', 'Processing', 'Shipped', 'Completed', 'Cancelled', 'Returned', 'On Hold']

      - name: total_amount
        description: |
          Total monetary amount for the order in USD, rounded to 2 decimal places.
          Represents gross revenue associated with the order.
          Used for sales and financial metric calculations.
          Sourced from raw_orders.total_amount.
        data_type: numeric(10,2)
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 1000000
```